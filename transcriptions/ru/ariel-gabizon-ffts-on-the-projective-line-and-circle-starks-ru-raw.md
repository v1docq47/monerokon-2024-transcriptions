# Ариэль Габизон

_**Быстрое преобразование Фурье на проективной прямой и круговые доказательства STARKs**_

_В презентации рассматриваются последние достижения в области применения быстрого преобразования Фурнье (FFT), описанные в соответствующих работах и позволяющие производить быстрое преобразование Fp при выполнении деления p+1 большой степенью двойки. В последнее время это вызывает большой интерес, поскольку позволяет использовать очень удобные поля простых чисел Мерсенна порядка 2^k-1._

[https://youtu.be/d1f9sBajj10](https://youtu.be/d1f9sBajj10)

---

_**Ариэль:**_ Итак, для начала вспомним, что такое классическое быстрое преобразование Фурнье, с которым, вероятно, вы знакомы. У нас есть некоторый набор степеней некоторого элемента g, и мы допускаем, что порядок g является степенью двойки. При этом мы хотим вычислить некоторый многочлен, степень которого будет меньше n, по точкам S. Такое преобразование довольно часто используется в случае с доказательствами SNARKs.

И основная хитрость, позволяющая сделать это эффективно, заключается в том, что мы разлагаем f на чётные и нечётные коэффициенты. Поэтому мы обозначаем f как f чётную от X в квадрате плюс X, умноженный на f нечётную от X в квадрате. Зачем мы это делаем? Затем, что теперь f чётные и f нечётные - это многочлены степени n, поделённые на 2, а не на n. А ещё это преобразование при переходе из X в квадрат X применительно к элементам S. Тогда это преобразование 2 в 1. Таким образом, мы свели вычисление одного многочлена степени n в n точек к вычислению двух многочленов степени n, поделённом на 2, в n, поделённом на 2, точек. И опять же, поскольку S имеет размер, равный степени 2, мы можем продолжить делать это рекурсивно, что даёт нам хорошо известное преобразование Фурнье за n log.

Честно, не знаю, кто разбирается ли кто-то из присутствующих во всём этом. Компилируется ли это с вашим опытом. Но спасибо.

Лично мне это нравится. Не знаю, что ещё можно было бы придумать, но люди всегда хотят большего, и поэтому спрашивают: "Ну, для того, чтобы получить такое g, нужно, чтобы степень 2 делилась на p минус 1", что, я думаю, нормально. Но, допустим, n вместо p минус 1 делит p плюс 1, где p - размер нашего поля. Можем ли мы по-прежнему использовать быстрое преобразование Фурнье?

Людей волнует этот вопрос, поскольку они хотят работать с полями, где p будет настолько простым, насколько это возможно, когда всё будет представлено в двоичной системе. Так что самое простое p из возможных - это простое число Мерсенна от 2 до k минус один. В частности особый интерес с точки зрения доказательств SNARKs вызывает число Мерсенна от 2 до 31 минус один. И если вы решите использовать этот вариант, у вас уже не будет p минус 1 поделённое на большую степень двойки. Но, очевидно, если это процент простого числа p плюс 1, например, число от 2 до 31 будет содержать большую степень двойки. Так можем ли мы произвести быстрое преобразование Фурнье, если n делит p плюс 1?

И давайте немного абстрактно поразмышляем о том, почему работает быстрое преобразование Фурнье. Итак, у нас есть преобразование из x в g, умноженное на x. И что хорошо в этом преобразовании, так это то, что циклически оно проходит через множество S. Когда вы начинаете с некоторой точки в S и применяете это преобразование, оно проходит через все точки в цикле.

Теперь, поскольку n - это степень двойки, а сигма - это цикл, если теперь определить преобразование тау как сигму, применённую n, поделённое на 2, раз, каким будет тау? В данном случае это будет просто преобразование x в минус x. Но уже просто из того факта, что сигма была циклом, вытекают две вещи. Мы знаем, что тау имеет значение второго порядка, а это значит, что если применить её дважды, то получится тождественное отображение. Таким образом, тау в квадрате x всегда будет x. А ещё мы знаем, что S должна разбиваться на несовпадающие пары. Если вы посмотрите на пары a, тау из a, то увидите, что эти пары являются непересекающимися. И ещё одна вещь, которую мы знаем: если взглянуть на преобразование x в x, умноженный на тау от x, можно подумать, что обозначение n используется из-за соответствия нормальным преобразованием распределений расширений. В данном случае это будет просто минус x в квадрате. Затем n преобразует пары в один и тот же результат. Поскольку пары похожи на a, тау из a, то, когда вы применяете это преобразование, x переходит в x, умноженный на тау из x, как и должен переходить, и тау тоже упорядочивается и также должно преобразовывать a и тау из a - пары должны преобразовываться в одно и то же.

Возникает вопрос: можем ли мы найти множество размера p плюс 1 и некоторую операцию сигма в нём, которые были бы такими же циклическими, как эта g?

И это вполне естественно приводит нас к тому, что принято называть проективной прямой. Итак, нам нужно получить множество размером p плюс 1, где поле будет иметь размер p. Поэтому естественным выбором для нас становится так называемая проективная прямая, когда мы просто берём поле и добавляем точку в бесконечности.

И теперь у нас есть это немного странное множество F, объединение полей, точка в бесконечности, и нам нужны операции, которые можно будет циклически применить к этому множеству. Естественными возможными операциями являются дробные преобразования. Мы можем взять, например, преобразование сигма x, которая преобразуется в 1 через a, x плюс b. И тогда возникает вопрос: "А как это преобразование определяется на p?". Итак, есть две точки, в которых вы не уверены, как себя должна вести сигма. Первая точка - это своего рода полюс. Сигма минус b, поделённые на a. В знаменателе мы получаем ноль. Поэтому мы просто определим сигму минус b, поделённые на a, как бесконечность. В свою очередь возникает следующий вопрос: "Во что же тогда преобразуется бесконечность?". Получается что-то вроде 1, поделённой на бесконечность. Таким образом, скажем так, сигма бесконечности стремится к 0.

И утверждение, которое содержится в работе Ли и Синга, лежащей в основе этого выступления, сводится к тому, что мы можем найти такие a и b, что использование сигмы даст нам цикл для всей P.

Теперь немного поговорим о том, что такое бесконечность множества F, и как формально представляют проективную прямую. Рассмотрим три варианта.

Первый - проективные координаты. Представим элементы поля как отношения, как пары c/d, где a будет отношением c к d. Далее, (a, 1) всегда будет представлять a. Таким образом, элемент поля имеет несколько представителей. Это то, что в проективном представлении кажется сложным и неудобным. Кроме того, когда вы представляете всё в виде отношений, когда в качестве правой координаты идёт 0, вполне естественно, что это будет бесконечность. Таким образом, мы можем рассматривать элементы (a, 0) в качестве представителей бесконечности.

И да, ещё одна из приятных сторон, не особо относящаяся к нашей теме, заключается в том, что, несмотря на то, что у элемента может быть много представителей, мы можем использовать однородные многочлены и вполне определённым образом сказать, что значит для многочлена совершать операции с нулём, проективной точкой, независимо от выбора представителя.

Таким образом, проективные координаты - это один из способов совершения операций с проективной линией. А ещё можно перейти от прямой к плоскости и окружности в этой плоскости. Не знаю, насколько понятен этот рисунок, но идея состоит в том, что теперь мы можем сопоставить точки окружности и прямой. Это всегда делается, начиная с северной точки окружности. И теперь, чтобы продемонстрировать, что точка на окружности соответствует точке на прямой, мы проводим линию для этой точки и смотрим, где она пересекается с прямой. Это даёт нам соответствие между окружностью и прямой. И вы можете спросить: "А что с точкой на севере окружности? Если провести касательную к окружности, где она встретится с прямой?". Ответ: эта точка проецируется в бесконечность. Или есть другой способ: взять бесконечную прямую и сделать из неё круг. И снова получается, что северная точка круга как бы проецируется на точку бесконечности. И в работе "Круговые доказательства STARK" используется именно такой подход к описанию быстрого преобразования Фурнье.

И третий способ представить проективную прямую. В данном случае всё описывается в более алгебраических и абстрактных терминах. Нам необходимо представить проективную прямую в виде так называемых точек полей рациональных функций.

Что это означает? В последней части своего выступления я попытаюсь составить у вас некоторое представление о том, что это значит. Итак, помните определение кольца? Кольцо - это множество элементов, замкнутых при сложении и умножении, при этом оно не обязательно будет обратимым. Таким образом, кольцо оценки поля K рациональных функций - это подкольцо, в котором каждый элемент поля либо он находится в кольце, либо его инверсия находится в кольце, либо и то, и другое - это нормально. Это и называется кольцом оценки. На первый взгляд очень абстрактное, специфическое определение. А как выглядят эти кольца оценки?

Итак, основной пример: в базовом поле выбирается некоторое a. Прошу прощения, F должна быть такой же, как и все остальные F. И мы, по сути, рассматриваем множество всех функций, которые не имеют полюса при a. То есть все f, поделённые на g, где g из a ненулевое. И мы можем убедиться в том, что это кольцо замкнуто при сложении и умножении. Также мы можем проверить, его соответствие определению, поскольку в случае с любой рациональной функцией, если она не имеет полюса в a, значит, она уже попадает в Ra. Если же имеет, то f, поделённое на g, если есть такое f, поделённое на g, где g имеет полюс в a - g, поделённое на f, не будет иметь полюса в a. Таким образом, это своего рода кольцо функций, которые хорошо определены в a. И эти кольца оценки также называются точками K.

И самое интересное, что с помощью этой схемы мы также можем производить абстрактную оценку в a. Так что единственным максимальным идеалом Ra всегда будет это множество, которое представляет собой все элементы Ra, умноженные на X минус a. И самое интересное, если мы хотим оценить какую-то функцию Ra в a, мы можем определить оценку как взятие этой функции Ia по модулю. Это даст нам некоторый элемент поля, и результат этой абстрактной операции будет таким же, как и при обычном оценивании функции в a.

Но если взглянуть в целом, есть некоторый способ определить степень для этих колец оценки. На самом деле, когда вы берете кольцо по модулю, его максимальный идеал, это будет некоторым алгебраическим расширением базового поля. Поэтому, какова бы ни была степень расширения, это будет степень точки. И есть ещё одна точка в K в поле рациональных функций, которую мы можем назвать бесконечностью R. И это все f, поделённые на g, где степень f меньше степени g.

И мы можем представить бесконечность как набор функций, которые можно оценить в бесконечности. Если степень g как минимум равна степени f, то, когда мы стремимся к бесконечности, в некотором смысле значение стремится не к бесконечности, а к некоторому конечному значению. Получается, что если мы начнём с этого очень абстрактного определения кольца оценки, то окажется, что кольца оценки первой степени - это как раз точки на проективной прямой.

Итак, мы начали с разговора о быстром преобразовании Фурнье, а затем перешли к этому действительно абстрактному понятию точки. Опять же, это не то, что можно объяснить за 20 минут, но всё же я пытаюсь кротко объяснить, какое отношение это имеет к преобразованию Фурнье. Итак, если вернуться немного назад, нам было нужно представить f как некоторую комбинацию двух функций fe(N(X)). В обычном преобразовании Фурнье это квадрат X. Просто X в квадрате. Но в данном контексте, поскольку мы собираемся начать с дробного преобразования, а не просто X стремится к g, умноженному на x, n будет некоторой рациональной функцией второй степени. И нам нужно выяснить, как объединить, как представить f в виде двух элементов, которые выглядят как n из x с половину степени, верно? Также возникает вопрос, что означает степень? Если очень коротко, то идея заключается в том, что работа с этими понятиями колец оценки, так называемыми полями функций и так называемыми пространствами Римана-Роха, о которых я ничего не сказал, даёт нам очень удобные инструменты для построения правильных базисов для представления f, fe и fo, а также такие определения, при которых f, fe and fo действительно будут иметь половину степени f, как при классическом быстром преобразовании Фурнье.

Итак, более подробную информацию можно найти в архиве, это работа Ли и Синга, статья называется… стыдно признаться, но я забыл точное название работы - что-то вроде G-FFT, Galois FFT. На этом всё. Спасибо за внимание.
